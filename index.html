<!DOCTYPE html>
<html>
<head>
  <title>Bonded Warehouse Simulation</title>
  <style>
    body { font-family: Arial; background: #f4f4f4; margin: 0; padding: 20px; }
    #simulation { margin-top: 20px; }
    .entry { margin: 10px 0; padding: 10px; background: #fff; border-left: 5px solid #007bff; }
    .expired { border-left-color: red; }
  </style>
</head>
<body>
  <h1>Bonded Warehouse Simulation</h1>
  <p>Each second represents 2 weeks. Total simulated time: 1.5 years.</p>
  <button onclick="startSim()">Start Simulation</button>
  <button onclick="pauseSim()">Pause</button>
  <button onclick="resetSim()">Reset</button>

  <div id="simulation"></div>

  <script>
    let simInterval;
    let currentTick = 0;
    const maxTicks = 39; // 1.5 years = 78 weeks / 2 weeks per second

    function generateBandLotEntry(tick) {
      const entry = {
        EntryID: `BND${tick}_2024`,
        BandLotID: `BND${tick}`,
        MaterialDescription: "AutoGen Material",
        InitialQuantity: Math.floor(Math.random() * 1000) + 100,
        Unit: "Kgs",
        RemainingQuantity: 0,
        CountryOfOrigin: "CountryX",
        BillOfLadingNumber: `BOL${tick}`,
        DateOfEntry: new Date(Date.now() + tick * 14 * 24 * 60 * 60 * 1000).toISOString().split("T")[0],
        CalculatedExpiryDate: new Date(Date.now() + (tick * 14 + 365) * 24 * 60 * 60 * 1000).toISOString().split("T")[0],
        DaysRemaining: 365 - (tick * 14),
        CustomsDutyValue: Math.floor(Math.random() * 1000000),
        Status: "In Bonded Warehouse"
      };
      entry.RemainingQuantity = entry.InitialQuantity;
      return entry;
    }

    function startSim() {
      simInterval = setInterval(() => {
        if (currentTick >= maxTicks) {
          clearInterval(simInterval);
          return;
        }

        const entry = generateBandLotEntry(currentTick);
        const container = document.getElementById("simulation");

        const div = document.createElement("div");
        div.className = "entry" + (entry.DaysRemaining <= 30 ? " expired" : "");
        div.innerHTML = `
          <strong>${entry.BandLotID}</strong><br>
          Material: ${entry.MaterialDescription}<br>
          Quantity: ${entry.InitialQuantity} ${entry.Unit}<br>
          Days Remaining: ${entry.DaysRemaining}
        `;
        container.appendChild(div);

        fetch("https://script.google.com/macros/s/AKfycbw5sO19MLnVtPHf-IekryBzcxsaoLE8kGhHbTrluRH_ErqPXjd9c_-v5vYDJmqhiWM0/exec", {
          
          method: "POST",
          body: JSON.stringify(entry),
          headers: {
            "Content-Type": "application/json"
          }
        });

        currentTick++;
      }, 1000);
    }

    function pauseSim() {
      clearInterval(simInterval);
    }

    function resetSim() {
      pauseSim();
      currentTick = 0;
      document.getElementById("simulation").innerHTML = "";
    }
  </script>
</body>
</html>
